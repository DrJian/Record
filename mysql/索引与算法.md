## B+树索引

### 聚簇索引

按照表的主键构造B+树，叶子节点由数据页组成，每一个数据页也有指向上一个页和下一个页的指针。

在使用聚簇索引时，由于叶节点即为数据所在，可以快速的取出数据所在的页，针对范围查找，连续数据的查找，可以通过非叶子节点快速取出页，速度快。

### 非聚簇索引

叶子节点除了对应键值，还包含了主键id。

### 索引管理

MYSQL对于索引的创建和删除，会采取先创建一张临时表，数据导入临时表后，删除原表，并将临时表命名为原表，效率上很差。但是在InnoDB Plus中，对于非聚簇索引有着更高效的处理方式，创建非聚簇索引时，会给表加上一个S锁，这时表为只读状态，同时进行索引生成。删除索引，只需要在内部视图下，将非聚簇索引的空间标位可用，并删除MYSQL内部视图的索引定义即可。

### 索引查看

`show index from table`

关注`cardinality`值，标志索引中唯一值的数目，该数除以表的总行数，应该尽可能接近1，比如主键索引的这个值/表行数一定是1，接近1的话，索引的区分度会更好，如果这个数字特别小，考虑是否还有建索引的必要。

`analyze table table_name`使用这个语句让mysql去重新分析表，在非高峰时期使用这个语句去更新核心表，提高索引和优化器的效果。

### 自适应哈希

使用哈希表来存储InnoDB页缓冲池中页的位置，针对部分等值查询，可以直接定位到缓冲中的数据页，取出数据页得到结果后返回，可以提高效率。